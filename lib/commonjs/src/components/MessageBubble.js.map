{"version":3,"file":"MessageBubble.js","sources":["../../../../src/components/MessageBubble.tsx"],"sourcesContent":["import { Message, MessageSource } from \"@yext/chat-headless-react\";\nimport { useComposedCssClasses } from \"../hooks\";\nimport { twMerge } from \"tailwind-merge\";\nimport { Markdown } from \"./Markdown\";\nimport { withStylelessCssClasses } from \"../utils/withStylelessCssClasses\";\nimport { FeedbackButtons, FeedbackButtonsCssClasses } from \"./FeedbackButtons\";\n\n/**\n * The CSS class interface for the {@link MessageBubble} component.\n *\n * @public\n */\nexport interface MessageBubbleCssClasses {\n  topContainer?: string;\n  subContainer?: string;\n  subContainer__bot?: string;\n  subContainer__user?: string;\n  bubble?: string;\n  bubble__bot?: string;\n  bubble__user?: string;\n  text?: string;\n  text__bot?: string;\n  text__user?: string;\n  timestamp?: string;\n  timestamp__bot?: string;\n  timestamp__user?: string;\n  feedbackButtonsCssClasses?: FeedbackButtonsCssClasses;\n}\n\nconst builtInCssClasses: MessageBubbleCssClasses =\n  withStylelessCssClasses<MessageBubbleCssClasses>(\"MessageBubble\", {\n    topContainer: \"w-full animate-fade-in @container\",\n    subContainer:\n      \"flex flex-col @lg:flex-row @lg:items-center @lg:gap-x-2 @lg:m-1\",\n    subContainer__bot: \"\",\n    subContainer__user: \"@lg:flex-row-reverse\",\n    bubble: \"relative group peer w-fit max-w-[80%] rounded-2xl p-4\",\n    bubble__bot: \"bg-gradient-to-tr from-slate-50 to-slate-100\",\n    bubble__user:\n      \"ml-auto @lg:ml-0 bg-gradient-to-tr from-blue-600 to-blue-700 text-white\",\n    text: \"text-[13px] @[480px]:text-base prose overflow-x-auto\",\n    text__bot: \"text-slate-900\",\n    text__user: \"text-white break-words\",\n    timestamp:\n      \"w-fit my-0.5 ml-4 @lg:ml-0 text-slate-400 text-[10px] @[480px]:text-[13px] opacity-0 peer-hover:opacity-100 duration-200 whitespace-pre-wrap\",\n    timestamp__bot: \"\",\n    timestamp__user: \"ml-auto\",\n    feedbackButtonsCssClasses: {},\n  });\n\n/**\n * The props for the {@link MessageBubble} component.\n *\n * @public\n */\nexport interface MessageBubbleProps {\n  /** The message to display. */\n  message: Message;\n  /**\n   * Whether to show the feedback buttons on the message bubble.\n   * Defaults to true.\n   */\n  showFeedbackButtons?: boolean;\n  /**\n   * Whether to show the timestamp of the message with the message bubble.\n   * Defaults to true.\n   */\n  showTimestamp?: boolean;\n  /**\n   * A function which is called to format the message's timestamp given in\n   * ISO format (e.g. \"2023-05-18T19:33:34.553Z\").\n   * Defaults to \"HH:MM A\" (e.g. \"7:33 PM\").\n   */\n  formatTimestamp?: (timestamp: string) => string;\n  /** CSS classes for customizing the component styling. */\n  customCssClasses?: MessageBubbleCssClasses;\n}\n\n/**\n * A component that displays the provided message.\n *\n * @public\n *\n * @param props - {@link MessageBubbleProps}\n */\nexport function MessageBubble({\n  message,\n  showFeedbackButtons = true,\n  showTimestamp = true,\n  customCssClasses,\n  formatTimestamp = defaultFormatTimestamp,\n}: MessageBubbleProps) {\n  console.log('MessageBubble!')\n\n  const cssClasses = useComposedCssClasses(builtInCssClasses, customCssClasses);\n  const bubbleCssClasses = twMerge(\n    cssClasses.bubble,\n    message.source === MessageSource.USER\n      ? cssClasses.bubble__user\n      : cssClasses.bubble__bot\n  );\n  const textCssClasses = twMerge(\n    cssClasses.text,\n    message.source === MessageSource.USER\n      ? cssClasses.text__user\n      : cssClasses.text__bot\n  );\n  const subContainerCssClasses = twMerge(\n    cssClasses.subContainer,\n    message.source === MessageSource.USER\n      ? cssClasses.subContainer__user\n      : cssClasses.subContainer__bot\n  );\n  const timestampCssClasses = twMerge(\n    cssClasses.timestamp,\n    message.source === MessageSource.USER\n      ? cssClasses.timestamp__user\n      : cssClasses.timestamp__bot\n  );\n\n  return (\n    <div className={cssClasses.topContainer}>\n      <div className={subContainerCssClasses}>\n        <div className={bubbleCssClasses}>\n          {showFeedbackButtons && message.source === MessageSource.BOT && (\n            <FeedbackButtons\n              customCssClasses={cssClasses.feedbackButtonsCssClasses}\n              responseId={message.responseId}\n            />\n          )}\n          <Markdown\n            content={message.text}\n            responseId={message.responseId}\n            className={textCssClasses}\n          />\n        </div>\n        {/* fallback on empty space here to perserve the height for timestamp div */}\n        {showTimestamp && (\n          <div className={timestampCssClasses}>\n            {message.timestamp ? formatTimestamp(message.timestamp) : \" \"}\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n\n/**\n * Formats message's timestamp from \"2023-05-18T19:33:34.553Z\" to \"7:33 PM\"\n *\n * @param timestamp - the timestamp to convert from\n * @returns formatted timestamp\n */\nfunction defaultFormatTimestamp(timestamp: string): string {\n  return new Date(timestamp).toLocaleString(undefined, {\n    hour: \"numeric\",\n    minute: \"numeric\",\n    hour12: true,\n  });\n}\n"],"names":["withStylelessCssClasses","useComposedCssClasses","twMerge","MessageSource","_jsx","_jsxs","FeedbackButtons","Markdown"],"mappings":"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"}